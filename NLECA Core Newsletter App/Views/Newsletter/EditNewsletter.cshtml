@using NLECA_Core_Newsletter_App.Models.Newsletter;
@model NewsletterModel

@{
    ViewData["Title"] = "Newsletter Editor";
    bool canEdit = User.IsInRole("SuperAdmin") || User.IsInRole("Admin");
    string editorEnabledDisabled = canEdit ? "" : "disabled";
}

@section Scripts{
    <script type="text/javascript" src="~/js/Newsletter/EditNewsletter.js"></script>
}

<h1>EditNewsletter</h1>

<form action="/Newsletter/UpdateNewsletter" method="post">
    <input type="hidden" name="newsletterId" value="@Model.NewsletterId" />
    <input type="hidden" name="oldMemo" value="@Model.Memo" />
    <input type="hidden" name="oldDisplayDate" value="@Model.DisplayDate" />

    <div id="memoArea">
        Memo: @Model.Memo
        <button type="button" id="memoEditButton">Edit</button>
    </div>

    <div id="memoEditArea" style="display: none;">
        <label for="memo">Updated Memo: </label>
        <input type="text" name="memo" value="@Model.Memo" placeholder="@Model.Memo" />
        <button type="button" id="memoEditCancel">Cancel</button>
    </div>

    <div id="displayDateArea">
        Display Date: @DateTime.Parse(Model.DisplayDate).ToString("MMMM yyyy")
        <button type="button" id="displayDateEditButton">Edit</button>
    </div>

    <div id="displayDateEditArea" style="display: none;">
        <input type="hidden" name="newsletterId" value="@Model.NewsletterId" />
        <label for="displayDate">Display Date: </label>
        <input type="month" id="start" name="displayDate" min="2018-03" value="@Model.DisplayDate">
        <button type="button" id="displayDateEditCancel">Cancel</button>

    </div>
    <button type="submit" id="memoAndDisplayDateSaveChanges">Save Changes</button>
</form>

<hr />
<button>Add Article Clipart</button>
<hr />

@foreach (ArticleModel article in Model.Articles)
{
    <div>@article.ArticleText</div>
    <div>
        <form action="/Article/EditArticle" method="post">
            <input type="hidden" name="articleId" value="@article.ArticleId" />
            <button type="submit">Edit</button>
        </form>

        <form action="/Article/RemoveArticle" method="post">
            <input type="hidden" name="newsletterId" value="@article.NewsletterId" />
            <input type="hidden" name="articleId" value="@article.ArticleId" />
            <button type="submit">Delete</button>
        </form>
    </div>
    <hr />
}

<div>
    <form action="/Article/AddArticle" method="post">
        <input type="hidden" name="newsletterId" value="@Model.NewsletterId" />
        <button type="submit" class="btn btn-primary" data-toggle="modal" data-target="#addArticleModal">Add Article</button>
    </form>
    <button>Change Article Order</button>
</div>
